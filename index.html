<!doctype html>
<html lang="de">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Brutto-Netto-Rechner für Zeitarbeit (mit AZK & Nachtschicht) | TimePartner</title>
<meta name="description" content="Schneller Brutto-Netto-Rechner für Zeitarbeit mit AZK-Übersicht, 25 % Nachtzuschlag, Steuerklasse, Kirchensteuer & Krankenkasse.">
<link rel="preconnect" href="https://fonts.googleapis.com" />
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@900&family=Nunito+Sans:wght@400;700&display=swap" rel="stylesheet" />

<style>
:root{
  --tp-blue:#0b2d42;        /* Primary Navy */
  --tp-blue-2:#123a57;      /* Hero/Panel Navy */
  --tp-green:#b6de36;       /* Accent */
  --tp-bg:#edf2f0;          /* Page BG */
  --tp-muted:#6f8a9b;       /* Muted text */
  --radius:14px;
}

/* Base */
*{box-sizing:border-box}
html,body{margin:0;font:400 16px/1.6 "Nunito Sans",system-ui,sans-serif;color:#0b2d42}
body{
  background:var(--tp-bg) url("assets/img/hintergrund.png") center/cover fixed; /* PNG verwendet */
  position:relative;
}
body::before{ /* leicht abdunkeln für Lesbarkeit */
  content:""; position:fixed; inset:0; z-index:-1;
  background:rgba(6,22,33,.28);
}
.container{max-width:1200px;margin:32px auto;padding:0 20px}

/* Cards / Panels */
.card{border-radius:20px;box-shadow:0 10px 26px rgba(11,45,66,.16);overflow:hidden}
.card.hero{background:linear-gradient(180deg,#0b2d42,#123a57);color:#fff;padding:28px;border:1px solid rgba(255,255,255,.08)}
.card.panel{background:#fff;padding:20px;border:1px solid #dfe6ea}
.card.result{background:#fff;padding:20px;border:1px solid #dfe6ea}

/* Headings */
h1{font:900 clamp(26px,4.6vw,40px)/1.15 "Poppins",sans-serif;margin:0;color:#fff}
h2{font:900 20px/1.2 "Poppins",sans-serif;margin:0 0 12px;color:var(--tp-blue)}
.hero-bullets{display:flex;gap:8px;flex-wrap:wrap;list-style:none;margin:12px 0 0;padding:0}
.hero-bullets li{color:#e8f3f8;font-weight:700;font-size:12px;background:rgba(255,255,255,.1);border:1px solid rgba(255,255,255,.18);padding:8px 10px;border-radius:999px}

/* Form */
fieldset{border:0;margin:18px 0 0;padding:0}
legend{margin:0 0 8px;font:900 16px/1.2 "Poppins";color:var(--tp-blue)}
label{display:block;font-weight:700;margin:0 0 6px;color:var(--tp-blue)}

input,select{
  width:100%; padding:12px 14px; border-radius:var(--radius);
  background:#fff; color:var(--tp-blue);
  border:2px solid #c9d3da; outline:none;
  transition:border-color .15s ease, box-shadow .15s ease;
}
input::placeholder{color:#a8b7c2}
input:focus,select:focus{border-color:var(--tp-green);box-shadow:0 0 0 3px rgba(182,222,54,.25)}
.hint{font-size:12px;color:var(--tp-muted);margin-top:6px}

.grid-2{display:grid;grid-template-columns:1fr;gap:14px}
.grid-3{display:grid;grid-template-columns:1fr;gap:14px}

/* Buttons – ohne „pressed“-Persistenz */
.btn{
  appearance:none; display:inline-flex; align-items:center; justify-content:center; gap:10px;
  padding:15px 18px; font:700 16px/1 "Nunito Sans";
  border-radius:var(--radius); cursor:pointer; user-select:none;
  border:2px solid var(--tp-green); transition:transform .03s ease, box-shadow .2s ease, background .2s ease;
}
.btn:focus-visible{outline:none; box-shadow:0 0 0 3px rgba(182,222,54,.45)}
.btn:active{transform:translateY(1px)}
.btn-primary{background:var(--tp-blue); color:#fff}
.btn-primary:hover{box-shadow:0 8px 18px rgba(11,45,66,.35)}
.btn-secondary{background:transparent; color:var(--tp-blue)}
.btn-secondary:hover{background:rgba(182,222,54,.12)}
@media (max-width:640px){.btn{width:100%}}

/* Toggle – flach & grün */
.switch{display:inline-grid;grid-auto-flow:column;align-items:center;gap:12px}
.switch input{
  appearance:none; width:44px; height:20px; border-radius:10px;
  background:#b9c7d1; position:relative; cursor:pointer; border:1px solid #a9bac5;
  transition:background .2s ease, border-color .2s ease;
}
.switch input::after{
  content:""; position:absolute; top:2px; left:2px; width:16px; height:16px; border-radius:8px;
  background:#fff; box-shadow:0 0 2px rgba(0,0,0,.25); transition:transform .2s ease;
}
.switch input:checked{background:var(--tp-green); border-color:var(--tp-green)}
.switch input:checked::after{transform:translateX(24px)}

/* Ergebnis */
.result-head{display:flex;justify-content:space-between;align-items:flex-end;gap:12px;margin-bottom:10px}
.result-head .net{font:900 32px/1 "Poppins"; color:var(--tp-green); letter-spacing:.2px}
.bar{height:10px;background:#e4ecf1;border-radius:999px;overflow:hidden;margin:12px 0}
.bar>i{display:block;height:100%;background:linear-gradient(90deg,var(--tp-green),#d5f16a);width:0%}
.note{font-size:12px;color:#4c5f6b}

/* Details „tabellarisch“ & luftiger */
#details > div{
  display:grid;
  grid-template-columns: 1fr auto;
  align-items:center;
  gap:14px;
  padding:8px 0;
  border-bottom:1px solid #e9eef1;
}
#details > div:last-child{border-bottom:0}

/* Desktop: mehr Luft & breiteres Ergebnis */
@media (min-width:1120px){
  .layout{
    display:grid;
    grid-template-columns: minmax(600px, 1fr) 480px;
    gap:28px;
    align-items:start;
  }
  .sticky{position:sticky;top:24px}
  .grid-2{grid-template-columns:1fr 1fr}
  .grid-3{grid-template-columns:repeat(3,1fr)}
}

/* Utilities */
.hidden{display:none}
</style>
</head>
<body>
  <main class="container">
    <!-- HERO -->
    <header class="card hero" aria-labelledby="title">
      <h1 id="title">Brutto-Netto-Rechner für Zeitarbeit</h1>
      <ul class="hero-bullets" aria-label="Highlights">
        <li>Schnell zum Netto</li><li>AZK transparent</li><li>Einfach & mobil</li>
      </ul>
    </header>

    <!-- INTRO -->
    <section id="intro" class="card panel" aria-label="Einstieg">
      <h2>Los geht’s – dein Beruf</h2>
      <label for="job">Beruf / Tätigkeit</label>
      <input id="job" type="text" list="jobsList" placeholder="z. B. Lagerhelfer, Produktionsmitarbeiter, Pflegekraft" />
      <datalist id="jobsList"></datalist>
      <p class="hint">Du kannst einen Vorschlag wählen oder frei eingeben.</p>
      <div style="margin-top:12px"><button id="startBtn" class="btn btn-secondary" type="button">Rechner starten</button></div>
    </section>

    <!-- LAYOUT -->
    <section id="tool" class="layout hidden" aria-label="Brutto-Netto-Rechner">
      <!-- FORM -->
      <section class="card panel">
        <h2>Eingaben</h2>
        <form id="calcForm" novalidate>
          <fieldset>
            <legend>Basis</legend>
            <div class="grid-2">
              <div>
                <label for="hourly">Stundenlohn (EUR/Std)</label>
                <input id="hourly" type="number" step="0.01" min="0" value="15" placeholder="z. B. 15" />
                <div class="hint">Monatsbrutto basiert auf 151,67&nbsp;Std.</div>
              </div>
              <div>
                <label for="hoursActual">Gesamtstunden (Monat)</label>
                <input id="hoursActual" type="number" step="0.01" min="0" value="160" />
                <div class="hint">Alles über 151,67&nbsp;Std geht ins AZK.</div>
              </div>
            </div>
          </fieldset>

          <fieldset>
            <legend>Nachtschicht</legend>
            <div class="grid-2">
              <div class="switch">
                <input id="permanent" type="checkbox" />
                <label for="permanent">Dauernachtschicht (100&nbsp;% Nachtstunden)</label>
              </div>
              <div id="nightBox">
                <label for="nightHours">Nachtstunden (Monat)</label>
                <input id="nightHours" type="number" step="0.01" value="20" />
                <div class="hint">Bei „Dauernacht“ nicht erforderlich.</div>
              </div>
            </div>
          </fieldset>

          <fieldset>
            <legend>Steuern &amp; Sozialversicherung</legend>
            <div class="grid-3">
              <div>
                <label for="state">Bundesland</label>
                <select id="state">
                  <option>Baden-Württemberg</option><option>Bayern</option><option>Berlin</option><option>Brandenburg</option>
                  <option>Bremen</option><option>Hamburg</option><option>Hessen</option><option>Mecklenburg-Vorpommern</option>
                  <option>Niedersachsen</option><option selected>Nordrhein-Westfalen</option><option>Rheinland-Pfalz</option>
                  <option>Saarland</option><option>Sachsen</option><option>Sachsen-Anhalt</option>
                  <option>Schleswig-Holstein</option><option>Thüringen</option>
                </select>
                <div class="switch" style="margin-top:10px">
                  <input id="church" type="checkbox" />
                  <label for="church">Kirchensteuerpflichtig</label>
                </div>
              </div>
              <div>
                <label for="taxClass">Steuerklasse</label>
                <select id="taxClass">
                  <option value="1">I</option><option value="2">II</option><option value="3" selected>III</option>
                  <option value="4">IV</option><option value="5">V</option><option value="6">VI</option>
                </select>
                <div class="hint">III niedrig, V hoch, I/IV mittel, II etwas günstiger, VI sehr hoch.</div>
              </div>
              <div>
                <label for="health">Krankenkasse – Zusatzbeitrag (%)</label>
                <input id="health" type="number" step="0.1" value="1.6" />
                <div class="hint">AN-KV ≈ 7,3&nbsp;% + (Zusatz/2).</div>
              </div>
            </div>

            <div class="grid-3" style="margin-top:14px">
              <div>
                <label for="childless">Kinder vorhanden?</label>
                <select id="childless">
                  <option value="no" selected>ja (mit Kind)</option>
                  <option value="yes">nein (kinderlos)</option>
                </select>
              </div>
              <div id="childrenWrapper">
                <label for="children">Kinder (Anzahl)</label>
                <input id="children" type="number" min="0" step="1" value="0" />
              </div>
            </div>
          </fieldset>

          <button id="calc" type="button" class="btn btn-primary">Netto berechnen</button>
        </form>
      </section>

      <!-- RESULT -->
      <aside id="resultWrap" class="card result sticky hidden" aria-live="polite">
        <h2>Ergebnis</h2>
        <div class="result-head">
          <div>Dein Netto</div>
          <div class="net" id="netOut">–</div>
        </div>
        <div class="bar" aria-label="Netto-Anteil von Brutto"><i id="barfill" style="width:0%"></i></div>
        <p class="note">Diese Berechnung ist eine vereinfachte, realistische Netto-Schätzung für Zeitarbeit. Abweichungen von ca. ±5&nbsp;% sind möglich.</p>

        <details style="margin-top:10px">
          <summary>Berechnung im Detail</summary>
          <div id="details" style="margin-top:10px"></div>
        </details>

        <div style="margin-top:12px"><button id="recalc" class="btn btn-secondary" type="button">Neu berechnen</button></div>
      </aside>
    </section>
  </main>

<script>
const $=id=>document.getElementById(id);
const HOURS=151.67;
const euro=n=>new Intl.NumberFormat('de-DE',{style:'currency',currency:'EUR'}).format(n);
const clamp=(v,a,b)=>Math.min(b,Math.max(a,v));
const churchPct=s=>(s==="Bayern"||s==="Baden-Württemberg")?8:9;

/* Start: Intro -> Tool */
$('startBtn').onclick=()=>{const j=$('job').value.trim(); if(!j){$('job').focus();return;}
  localStorage.tp_job=j; document.getElementById('intro').classList.add('hidden'); document.getElementById('tool').classList.remove('hidden'); $('hourly').focus();
};

/* UX-Logik */
$('permanent').onchange=e=>{ document.getElementById('nightBox').classList.toggle('hidden',e.target.checked); };
$('childless').addEventListener('change',e=>{ document.getElementById('childrenWrapper').style.display = e.target.value==='no' ? 'block' : 'none'; });

/* Sozialversicherung (vereinfacht, AN-Anteil) */
function sv(g,zusatz,isChildless,state){
  const kv=g*(0.073 + (zusatz/100)/2), rv=g*0.093, av=g*0.013;
  let pv=g*(isChildless?0.023:0.017); if(state==="Sachsen") pv+=g*0.0035;
  return {t:kv+rv+av+pv,kv,rv,av,pv};
}
/* Lohnsteuer (vereinfachte Klassen-Schätzung) */
function tax(taxable,klass,children){
  const base={1:.16,2:.15,3:.08,4:.16,5:.24,6:.30}[+klass] ?? .16;
  const relief=Math.min(.02,.01*(+children||0));
  const rate=Math.max(0,base-relief);
  return {a:taxable*rate,r:rate};
}

function calculate(){
  const h=+$('hourly').value||0, hs=+$('hoursActual').value||0, nh=+$('nightHours').value||0,
        permanent=$('permanent').checked, state=$('state').value, klass=$('taxClass').value,
        zusatz=+$('health').value||1.6, kids=+$('children').value||0, childless=$('childless').value==='yes', churchOn=$('church').checked;

  const base=h*HOURS;
  const extra=Math.max(0,hs-HOURS); const azk=extra*h;
  const fraction=permanent?1:(hs?clamp(nh/hs,0,1):0);
  const night=base*0.25*fraction;

  const gross=base+night;
  const S=sv(gross,zusatz,childless,state);
  const taxable=Math.max(0,gross-S.t);
  const T=tax(taxable,klass,kids);
  const cp=churchOn?churchPct(state):0;
  const church=T.a*(cp/100);

  const deductions=S.t+T.a+church;
  const net=Math.max(0,gross-deductions);
  const pct=gross?Math.round(net/gross*100):0;

  /* Ausgabe */
  $('resultWrap').classList.remove('hidden');
  $('netOut').textContent=euro(net);
  $('barfill').style.width=pct+'%';

  $('details').innerHTML=`
    <div>Stundenlohn × 151,67 Std <b>${euro(base)}</b></div>
    <div>Nachtzuschlag (25% · ${permanent?'Dauernacht':(fraction*100).toFixed(0)+'%'} ) <b>+ ${euro(night)}</b></div>
    <div>AZK-Zuwachs <b>+ ${extra.toFixed(2)} Std (${euro(azk)})</b></div>
    <div>Sozialabgaben ges. <b>− ${euro(S.t)}</b></div>
    <div>— KV / RV / AV / PV <b>− ${euro(S.kv)} / ${euro(S.rv)} / ${euro(S.av)} / ${euro(S.pv)}</b></div>
    <div>Lohnsteuer (Kl. ${klass}) <b>− ${euro(T.a)}</b></div>
    <div>Kirchensteuer ${churchOn?'('+cp+'%)':'(aus)'} <b>− ${euro(church)}</b></div>
  `;
}

/* Aktionen */
$('calc').onclick=calculate;
$('recalc').onclick=()=>{ document.getElementById('resultWrap').classList.add('hidden'); document.getElementById('calcForm').scrollIntoView({behavior:'smooth'}); };

/* Jobtitel-Datalist aus CSV: assets/data/jobtitel.csv */
(async function loadJobs(){
  const list = document.getElementById('jobsList');
  if(!list) return;
  try {
    const res = await fetch('assets/data/jobtitel.csv', {cache:'no-store'});
    if(!res.ok) throw new Error('CSV not found');
    const text = await res.text();
    const rows = text.split(/\r?\n/).map(s=>s.trim()).filter(Boolean);
    const uniq = Array.from(new Set(rows)).slice(0,1000);
    list.innerHTML = uniq.map(t=>`<option value="${t}"></option>`).join('');
  } catch(e){
    console.warn('Jobtitel-CSV konnte nicht geladen werden:', e);
  }
})();
</script>
</body>
</html>
