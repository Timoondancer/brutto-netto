<!doctype html>
<html lang="de">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Zeitarbeitsrechner – Brutto/Netto, Nachtschicht & AZK</title>
  <style>
    :root { --pri:#0b2d43; --acc:#b5dd35; --bg:#f4f6f8; }
    *{box-sizing:border-box}
    body{font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;background:var(--bg);margin:0;color:#0b2d43;line-height:1.5}
    .wrap{max-width:1000px;margin:40px auto;padding:20px}
    .card{background:#fff;border:1px solid #e7ecf0;border-radius:18px;box-shadow:0 6px 24px rgba(11,45,67,.08);padding:28px}
    h1{margin:0 0 6px 0;font-size:28px;font-weight:900;color:#0b2d43;letter-spacing:.2px}
    .subtitle{margin:0 0 18px;color:#0b2d43;opacity:.7;font-size:13px}
    p.lead{margin:0 0 18px;color:#0b2d43;opacity:.85}
    label{font-weight:700;font-size:14px;margin-bottom:8px;display:block;color:#0b2d43}
    input,select{width:100%;padding:14px 14px;border:2px solid #cfd8df;border-radius:14px;outline:none;background:#fff;color:#0b2d43}
    input:focus,select:focus{border-color:var(--pri);box-shadow:0 0 0 4px rgba(11,45,67,.12)}
    .row{display:grid;grid-template-columns:1fr 1fr;gap:18px}
    .row3{display:grid;grid-template-columns:1fr 1fr 1fr;gap:18px}
    .mt{margin-top:16px} .mt2{margin-top:24px}
    .btn{display:inline-block;background:var(--pri);color:#fff;border:none;border-radius:14px;padding:12px 18px;font-weight:800;cursor:pointer;box-shadow:0 6px 16px rgba(11,45,67,.2)}
    .btn:focus{outline:none;box-shadow:0 0 0 4px rgba(11,45,67,.25)}
    .pill{display:inline-flex;align-items:center;gap:10px;background:#0b2d430d;border:1px solid #0b2d4320;border-radius:999px;padding:10px 14px}
    .switch{position:relative;width:58px;height:32px;background:#d5dde3;border-radius:999px;cursor:pointer;transition:background .2s, box-shadow .2s}
    .knob{position:absolute;top:3px;left:3px;width:26px;height:26px;background:#fff;border-radius:50%;box-shadow:0 2px 6px rgba(0,0,0,.15);transition:left .2s}
    .switch.on{background:#0b2d43} .switch.on .knob{left:29px}
    .note{font-size:12px;color:#0b2d43;opacity:.75}
    .result{background:#fff;border:1px solid #e7ecf0;border-radius:16px;padding:16px;box-shadow:0 4px 16px rgba(11,45,67,.06)}
    .section{border:1px dashed #dfe6eb;border-radius:14px;padding:12px 14px;background:#f9fbfc}
    .kv{display:flex;justify-content:space-between;padding:12px 14px;border-radius:10px}
    .kv + .kv{margin-top:8px}
    .kv.head{background:#0b2d430a;color:#0b2d43;font-weight:800}
    .hl{color:var(--acc);font-weight:900}
    .mono{font-variant-numeric:tabular-nums}
    .hidden{display:none}
    .tag{display:inline-block;background:#0b2d430d;border:1px solid #0b2d4320;border-radius:10px;padding:5px 8px;font-size:12px;margin-left:8px;color:#0b2d43}
    .divider{height:1px;background:#e7ecf0;margin:14px 0}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <h1>Brutto/Netto Rechner</h1>
      <div class="subtitle">Untertitel von Stephanie Geiges</div>
      <p class="lead">Für Zeitarbeit: automatisches Monats-Soll <strong>151,67&nbsp;Std</strong>, Nachtschicht-Zulage <strong>+25&nbsp;%</strong> (anteilig, vor Abzügen) und transparentes <strong>AZK</strong>.</p>

      <div class="row">
        <div>
          <label for="hourly">Stundenlohn (EUR/Std)</label>
          <input id="hourly" type="number" inputmode="decimal" value="20">
          <div class="note mt">Basis für die Monatsberechnung (151,67&nbsp;Std).</div>
        </div>
        <div>
          <label for="hoursActual">Gesamtstunden (Monat)</label>
          <input id="hoursActual" type="number" inputmode="decimal" value="160">
          <div class="note mt">Alles über 151,67&nbsp;Std wandert ins AZK.</div>
        </div>
      </div>

      <div class="row mt">
        <div>
          <label>Nachtschicht</label>
          <div class="pill">
            <span>Dauernachtschicht (100&nbsp;% Nachtstunden)</span>
            <div id="permanentToggle" class="switch" role="switch" aria-checked="false" tabindex="0"><div class="knob"></div></div>
          </div>
          <div class="note mt">Wenn aus, unten Nachtstunden eingeben – Zuschlag 25&nbsp;% anteilig.</div>
        </div>
        <div id="hoursNightBox">
          <label for="nightHours">Nachtstunden (Monat)</label>
          <input id="nightHours" type="number" inputmode="decimal" value="56">
          <div class="note mt">z.&nbsp;B. ~1/3 der Zeit bei Drei-Schicht.</div>
        </div>
      </div>

      <div class="row3 mt2">
        <div>
          <label for="state">Bundesland (Kirchensteuer)</label>
          <select id="state">
            <option>Baden-Württemberg</option><option>Bayern</option><option>Berlin</option><option>Brandenburg</option>
            <option>Bremen</option><option>Hamburg</option><option>Hessen</option><option>Mecklenburg-Vorpommern</option>
            <option>Niedersachsen</option><option>Nordrhein-Westfalen</option><option selected>Rheinland-Pfalz</option><option>Saarland</option>
            <option>Sachsen</option><option>Sachsen-Anhalt</option><option>Schleswig-Holstein</option><option>Thüringen</option>
          </select>
          <div class="note mt">Kirchensteuer: 8&nbsp;% in BY/BW, sonst 9&nbsp;%.</div>
        </div>
        <div>
          <label for="taxClass">Steuerklasse</label>
          <select id="taxClass">
            <option value="1">I</option><option value="2">II</option><option value="3" selected>III</option>
            <option value="4">IV</option><option value="5">V</option><option value="6">VI</option>
          </select>
        </div>
        <div>
          <label for="health">Krankenkasse – Zusatzbeitrag (%)</label>
          <input id="health" type="number" step="0.1" value="1.6">
          <div class="note mt">AN-KV = 7,3&nbsp;% + Zusatz/2</div>
        </div>
      </div>

      <div class="row mt">
        <div>
          <label for="children">Kinder (Anzahl)</label>
          <input id="children" type="number" min="0" step="1" value="0">
        </div>
        <div>
          <label for="childless">Kinder vorhanden?</label>
          <select id="childless"><option value="no" selected>ja (mit Kind)</option><option value="yes">nein (kinderlos)</option></select>
          <div class="note mt">PV: 1,7&nbsp;% mit Kind, 2,3&nbsp;% ohne; Sachsen +0,35&nbsp;pp.</div>
        </div>
        <div>
          <label for="job">Beruf / Einsatz (optional)</label>
          <input id="job" placeholder="z. B. Lagerhelfer">
        </div>
      </div>

      <div class="mt2">
        <button id="calc" class="btn">Netto berechnen</button>
        <span class="tag" id="churchTag">Kirchensteuer: 9 %</span>
      </div>

      <div id="out" class="mt2 result" aria-live="polite"></div>
    </div>
  </div>

<script>
(function(){
  const el = (id)=>document.getElementById(id);
  const state = { permanent:false };
  const HOURS_TARGET = 151.67;

  function clamp(v, min, max){ return Math.min(max, Math.max(min, v)); }
  function euro(n){ return (n<0?"− ":"") + Math.abs(n).toFixed(2) + " €"; }
  function churchPctByState(name){ return (name === "Bayern" || name === "Baden-Württemberg") ? 8 : 9; }

  function socialInsurance(gross, zusatzPct, childless, stateName){
    const kvRate = 0.073 + (zusatzPct/100)/2;
    const rvRate = 0.093;
    const avRate = 0.013;
    let pvRate = childless ? 0.023 : 0.017;
    if (stateName === "Sachsen") pvRate += 0.0035;
    const kv = gross * kvRate, rv = gross * rvRate, av = gross * avRate, pv = gross * pvRate;
    return { total: kv+rv+av+pv, parts:{kv,rv,av,pv}, rates:{kv:kvRate, rv:rvRate, av:avRate, pv:pvRate} };
  }

  function wageTax(taxable, taxClass, children){
    let base = (taxClass==="3") ? 0.08 : (taxClass==="5"||taxClass==="6" ? 0.22 : 0.15);
    const relief = Math.min(0.02, 0.01*(+children||0));
    const rate = Math.max(0, base - relief);
    return { amount: taxable*rate, rate };
  }

  function calc(){
    const hourly = +el('hourly').value || 0;
    const hoursActual = +el('hoursActual').value || 0;
    const nightHours = +el('nightHours').value || 0;
    const taxClass = el('taxClass').value;
    const children = +el('children').value || 0;
    const childless = el('childless').value === "yes";
    const stateName = el('state').value;
    const zusatz = +el('health').value || 1.6;

    const baseGross = hourly * HOURS_TARGET;

    const extraHours = Math.max(0, hoursActual - HOURS_TARGET);
    const azkValue = extraHours * hourly;

    const fraction = state.permanent ? 1 : (hoursActual>0 ? clamp(nightHours/hoursActual,0,1) : 0);
    const nightAllowance = baseGross * 0.25 * fraction;

    const grossEff = baseGross + nightAllowance;

    const sv = socialInsurance(grossEff, zusatz, childless, stateName);
    const taxable = Math.max(0, grossEff - sv.total);
    const tax = wageTax(taxable, taxClass, children);
    const churchPct = churchPctByState(stateName);
    const church = tax.amount * (churchPct/100);

    const net = Math.max(0, grossEff - (sv.total + tax.amount + church));

    document.getElementById('churchTag').textContent = "Kirchensteuer: " + churchPct + " %";

    const protocol = `
      <div class="section">
        <div class="kv"><span>Monats-Soll</span><span class="mono">151,67 Std</span></div>
        <div class="kv"><span>Tatsächliche Stunden</span><span class="mono">${hoursActual.toFixed(2)} Std</span></div>
        <div class="kv"><span>AZK-Zuwachs</span><span class="mono">+ ${extraHours.toFixed(2)} Std (${euro(azkValue)})</span></div>
      </div>
    `;

    const html = `
      ${protocol}
      <div class="divider"></div>
      <div class="kv head"><span>Berechnungsbasis</span><span></span></div>
      <div class="kv"><span>Stundenlohn</span><span class="mono">${euro(hourly)}</span></div>
      <div class="kv"><span>Brutto (Basis · 151,67 Std)</span><span class="mono">${euro(baseGross)}</span></div>
      <div class="kv"><span>Nachtschicht-Zulage (25% · ${state.permanent ? "Dauernacht" : (fraction*100).toFixed(0)+"%"} der Stunden)</span><span class="mono">+ ${euro(nightAllowance)}</span></div>

      <div class="kv head"><span>Brutto (auszahlungsrelevant)</span><span class="mono hl">${euro(grossEff)}</span></div>

      <div class="kv head"><span>Sozialabgaben (AN)</span><span class="mono">− ${euro(sv.total)}</span></div>
      <div class="kv"><span>Krankenkasse</span><span class="mono">− ${euro(sv.parts.kv)}</span></div>
      <div class="kv"><span>Rentenversicherung</span><span class="mono">− ${euro(sv.parts.rv)}</span></div>
      <div class="kv"><span>Arbeitslosenversicherung</span><span class="mono">− ${euro(sv.parts.av)}</span></div>
      <div class="kv"><span>Pflegeversicherung</span><span class="mono">− ${euro(sv.parts.pv)}</span></div>

      <div class="kv head"><span>Lohnsteuer (Demo)</span><span class="mono">− ${euro(tax.amount)} <span class="tag">${(tax.rate*100).toFixed(1)} %</span></span></div>
      <div class="kv"><span>Kirchensteuer</span><span class="mono">− ${euro(church)}</span></div>

      <div class="kv head"><span>Netto (geschätzt)</span><span class="mono hl">${euro(net)}</span></div>

      <div class="note mt">Hinweis: Zeitguthaben (AZK) kann jederzeit über Abschläge ausbezahlt werden – je nach betrieblicher Regelung.</div>
    `;
    document.getElementById('out').innerHTML = html;
  }

  function bindToggle(id, onChange){
    const t = document.getElementById(id);
    let on = false;
    function set(v){ on=v; t.classList.toggle('on', on); t.setAttribute('aria-checked', on?"true":"false"); onChange(on); }
    t.addEventListener('click', ()=> set(!on));
    t.addEventListener('keydown', (e)=>{ if(e.key===' '||e.key==='Enter'){ e.preventDefault(); set(!on); }});
    set(false);
  }
  bindToggle('permanentToggle', (isOn)=>{
    document.getElementById('hoursNightBox').classList.toggle('hidden', isOn);
    calc();
  });

  ['hourly','hoursActual','nightHours','taxClass','children','childless','state','health']
    .forEach(id=>{
      const node = document.getElementById(id);
      node.addEventListener('input', calc);
      node.addEventListener('change', calc);
    });

  document.getElementById('calc').addEventListener('click', calc);
  calc();
})();
</script>
</body>
</html>
